{
  "hash": "5379d3ce7449f0fc2bdf4fc0e78d8166",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Re-Design\"\nformat: html\neditor: visual\n---\n\n\n## Re-Design : \n\nI want to make a bad graph better using what I know. I aim to create a perfect and easily understandable graph. Additionally, I plan to visualize the data in various graphs to check if any new information emerges beyond my current understanding.\n\n**The SAS website gave me the original data for \"Immigrant Visa Number Use by Category Fiscal Year 2014:**\n\n![](images/visas_table_orig (1).png){fig-align=\"center\" width=\"500\"}\n\n##### Fig1:  **2024 Immigration Visa Data Table**\n\nI'm making a data frame called \"**ImmigrantVisaNumber2014**\" and adding columns named \"Category,\" \"**Visa Issuances at Offices Abroad**,\" and \"**USCIS Adjustments**\", I'm putting in the data from **Fig1** into these columns.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nImmigrantVisaNumber2014 = data.frame( \nCategory = factor(c(\"F1\", \"F2A\", \"F2B\", \"F4\", \"E1\", \"E2\", \"E3\", \"E4\", \"E5\", \"DV\"), levels = c(\"F1\", \"F2A\", \"F2B\", \"F4\", \"E1\", \"E2\", \"E3\", \"E4\", \"E5\", \"DV\")), \nVisa_Issuances_At_Offices_Abroad = c(21511, 80041, 15137, 21931, 59140, 1680, 1880, 7088, 1489, 9228), \nUSCIS_Adjustments = c(2480, 9451, 2382, 2100, 7020, 38928, 47191, 35611, 6798, 1464) \n) \n```\n:::\n\n\n#### **Re-Design 1: Bar Plot with GGplot2** \n\n-   Implemented the GGplot2 library to re-imagine the visualization, showcasing a bar plot utilizing the given data values.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)  \nmelted_data = reshape2::melt(ImmigrantVisaNumber2014, id.vars = \"Category\")  \n\n# Reorder the levels of the variable factor \nmelted_data$variable = factor(melted_data$variable, levels = \nc(\"Visa_Issuances_At_Offices_Abroad\",\"USCIS_Adjustments\")) \nggplot(melted_data, aes(x = Category, y = value, fill = variable)) +\ngeom_bar(stat = \"identity\", width = 0.4) +  \nlabs(title = \"Immigrant Visa Number\\nUse By Category\\nFiscal Year 2014\",x = \"Category\", y = \"Count\") +  \nscale_fill_manual(values = c(\"USCIS_Adjustments\" = \"indianred\", \"Visa_Issuances_At_Offices_Abroad\" = \"steelblue\")) +  \ntheme(legend.position = \"bottom\", \n      text = element_text(size = 10, face = \"bold\"), \n      axis.text.x = element_text(size = 6, face = \"bold\"), \n      axis.text.y = element_text(size = 6, face = \"bold\"), \n      axis.title.x = element_text(size = 10, face = \"bold\"), \n      axis.title.y = element_text(size = 10, face = \"bold\"), \n      plot.title = element_text(size = 10, face = \"bold\", hjust = 0.5),\n      legend.title = element_text(face = \"bold\")) + \nguides(fill = guide_legend(title = NULL)) \n```\n\n::: {.cell-output-display}\n![](Re-Design_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nThe initial graph used a 3D model, which can sometimes be confusing and make it challenging for viewers to understand the data. The redesigned graph, now in a simpler 2D format, is clearer and more user-friendly.\n\n![](images/fig2-01.jpg){fig-align=\"center\"}\n\nI made a change in the Redesign1 by using **Plotly library** and **Position = 'dodge'** and **width** of the bars are **0.7** to compare 'Visa Issuances at Offices Abroad' and 'USCIS Adjustments' more effectively. In the initial design, I found a bit of difficulty in understanding the bar representing 'Visa Issuances at Offices Abroad,' so I placed both bars side by side to enhance clarity and better comprehend the comparison\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(reshape2)\nlibrary(plotly)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'plotly'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:ggplot2':\n\n    last_plot\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:stats':\n\n    filter\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:graphics':\n\n    layout\n```\n\n\n:::\n\n```{.r .cell-code}\n# Melt the data frame\nmelted_data <- reshape2::melt(ImmigrantVisaNumber2014, id.vars = \"Category\")\n\n# Reorder the levels of the variable factor\nmelted_data$variable <- factor(melted_data$variable, levels = c(\"Visa_Issuances_At_Offices_Abroad\", \"USCIS_Adjustments\"))\n\n# Create a ggplot object with dodge positioning\ngg <- ggplot(melted_data, aes(x = Category, y = value, fill = variable)) +\n  geom_bar(stat = \"identity\", position = \"dodge\", width = 0.7) +\n  labs(title = \"Immigrant Visa Number Use By Category Fiscal Year 2014\", x = \"Category\", y = \"Count\") +\n  scale_fill_manual(values = c(\"USCIS_Adjustments\" = \"indianred\", \"Visa_Issuances_At_Offices_Abroad\" = \"steelblue\")) +\n  theme(legend.position = \"bottom\",\n        text = element_text(size = 10, face = \"bold\"),\n        axis.text.x = element_text(size = 6, face = \"bold\"),\n        axis.text.y = element_text(size = 6, face = \"bold\"),\n        axis.title.x = element_text(size = 10, face = \"bold\"),\n        axis.title.y = element_text(size = 10, face = \"bold\"),\n        plot.title = element_text(size = 9, face = \"bold\", hjust = 0.5),  # Add a comma here\n        legend.title = element_text(face = \"bold\")) +\n  guides(fill = guide_legend(title = NULL))\n\n# Convert ggplot object to plotly object\nplotly_gg <- ggplotly(gg)\n\n# Modify the plotly object to move the legend below\nplotly_gg <- plotly_gg %>%\n  layout(legend = list(orientation = \"h\", y = -0.2, x = 0.2))\n\n# Print the interactive plot\nprint(plotly_gg)\n```\n:::\n\n\nAfter redesigning the graph with Plotly, I've made it more user-friendly and easy to understand for everyone.\n\n![](images/1 .png){fig-align=\"center\" width=\"700\"}\n\n**Fig3: Redesigned Graph (using Plotly)**\n\n#### **Re-Design 2: Line Plot with GGplot2** \n\nI'm examining the visa trends for the year 2024, specifically focusing on the counts for 'Visa Issuances at Offices Abroad' and 'USCIS Adjustments.' By analyzing these columns individually, I aim to gain insights into the distribution and trends of visas issued in each category for the specified year.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2) \nlibrary(plotly) \nbase_plot = ggplot(melted_data, aes(x = Category, y = value, color = variable, group = variable)) + geom_line() + facet_wrap(~variable, scales = \"free_y\") + \nlabs(title = \"Immigrant Visa Number Use By Category FY 2014\", x = \"Category\", y = \"Count\") + \nscale_color_manual(values = c(\"Visa_Issuances_At_Offices_Abroad\" = \"skyblue\", \"USCIS_Adjustments\" = \"red\")) + theme(legend.position = \"bottom\") \n\n# Convert ggplot to a plotly object \nhighlight_plot = ggplotly(base_plot, tooltip = c(\"Category\", \"value\", \"variable\")) \n\n# Move the legend below the plot \nhighlight_plot = highlight_plot %>%  \nlayout(legend = list(orientation = \"h\", x = 0.5, y = -0.1, traceorder = 'normal')) \n\n# Adjust the title size or width \nhighlight_plot = highlight_plot %>%  \nlayout(title = list(text = \"Immigrant Visa Number Use By Category FY 2014\", x = 0.5, xanchor = \"center\")) \n\n# Display the interactive plot \nhighlight_plot \n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-7fb4775f9c268df31339\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-7fb4775f9c268df31339\">{\"x\":{\"data\":[{\"x\":[1,2,3,4,5,6,7,8,9,10],\"y\":[21511,80041,15137,21931,59140,1680,1880,7088,1489,9228],\"text\":[\"Category: F1<br />value: 21511<br />variable: Visa_Issuances_At_Offices_Abroad<br />variable: Visa_Issuances_At_Offices_Abroad\",\"Category: F2A<br />value: 80041<br />variable: Visa_Issuances_At_Offices_Abroad<br />variable: Visa_Issuances_At_Offices_Abroad\",\"Category: F2B<br />value: 15137<br />variable: Visa_Issuances_At_Offices_Abroad<br />variable: Visa_Issuances_At_Offices_Abroad\",\"Category: F4<br />value: 21931<br />variable: Visa_Issuances_At_Offices_Abroad<br />variable: Visa_Issuances_At_Offices_Abroad\",\"Category: E1<br />value: 59140<br />variable: Visa_Issuances_At_Offices_Abroad<br />variable: Visa_Issuances_At_Offices_Abroad\",\"Category: E2<br />value:  1680<br />variable: Visa_Issuances_At_Offices_Abroad<br />variable: Visa_Issuances_At_Offices_Abroad\",\"Category: E3<br />value:  1880<br />variable: Visa_Issuances_At_Offices_Abroad<br />variable: Visa_Issuances_At_Offices_Abroad\",\"Category: E4<br />value:  7088<br />variable: Visa_Issuances_At_Offices_Abroad<br />variable: Visa_Issuances_At_Offices_Abroad\",\"Category: E5<br />value:  1489<br />variable: Visa_Issuances_At_Offices_Abroad<br />variable: Visa_Issuances_At_Offices_Abroad\",\"Category: DV<br />value:  9228<br />variable: Visa_Issuances_At_Offices_Abroad<br />variable: Visa_Issuances_At_Offices_Abroad\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(135,206,235,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"Visa_Issuances_At_Offices_Abroad\",\"legendgroup\":\"Visa_Issuances_At_Offices_Abroad\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1,2,3,4,5,6,7,8,9,10],\"y\":[2480,9451,2382,2100,7020,38928,47191,35611,6798,1464],\"text\":[\"Category: F1<br />value:  2480<br />variable: USCIS_Adjustments<br />variable: USCIS_Adjustments\",\"Category: F2A<br />value:  9451<br />variable: USCIS_Adjustments<br />variable: USCIS_Adjustments\",\"Category: F2B<br />value:  2382<br />variable: USCIS_Adjustments<br />variable: USCIS_Adjustments\",\"Category: F4<br />value:  2100<br />variable: USCIS_Adjustments<br />variable: USCIS_Adjustments\",\"Category: E1<br />value:  7020<br />variable: USCIS_Adjustments<br />variable: USCIS_Adjustments\",\"Category: E2<br />value: 38928<br />variable: USCIS_Adjustments<br />variable: USCIS_Adjustments\",\"Category: E3<br />value: 47191<br />variable: USCIS_Adjustments<br />variable: USCIS_Adjustments\",\"Category: E4<br />value: 35611<br />variable: USCIS_Adjustments<br />variable: USCIS_Adjustments\",\"Category: E5<br />value:  6798<br />variable: USCIS_Adjustments<br />variable: USCIS_Adjustments\",\"Category: DV<br />value:  1464<br />variable: USCIS_Adjustments<br />variable: USCIS_Adjustments\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(255,0,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"USCIS_Adjustments\",\"legendgroup\":\"USCIS_Adjustments\",\"showlegend\":true,\"xaxis\":\"x2\",\"yaxis\":\"y2\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":55.452054794520549,\"r\":7.3059360730593621,\"b\":40.182648401826498,\"l\":54.794520547945211},\"plot_bgcolor\":\"rgba(235,235,235,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Immigrant Visa Number Use By Category FY 2014\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0.5,\"xref\":\"paper\",\"xanchor\":\"center\"},\"xaxis\":{\"domain\":[0,0.44465199944652001],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,10.6],\"tickmode\":\"array\",\"ticktext\":[\"F1\",\"F2A\",\"F2B\",\"F4\",\"E1\",\"E2\",\"E3\",\"E4\",\"E5\",\"DV\"],\"tickvals\":[1,2,3,4,5,6.0000000000000009,7,8,9,10],\"categoryorder\":\"array\",\"categoryarray\":[\"F1\",\"F2A\",\"F2B\",\"F4\",\"E1\",\"E2\",\"E3\",\"E4\",\"E5\",\"DV\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y\",\"title\":\"\",\"hoverformat\":\".2f\"},\"annotations\":[{\"text\":\"Category\",\"x\":0.5,\"y\":0,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"top\",\"annotationType\":\"axis\",\"yshift\":-21.917808219178081},{\"text\":\"Count\",\"x\":0,\"y\":0.5,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-90,\"xanchor\":\"right\",\"yanchor\":\"center\",\"annotationType\":\"axis\",\"xshift\":-39.452054794520549},{\"text\":\"Visa_Issuances_At_Offices_Abroad\",\"x\":0.22232599972326,\"y\":1,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"},{\"text\":\"USCIS_Adjustments\",\"x\":0.77767400027673994,\"y\":1,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"}],\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-2438.6000000000004,83968.600000000006],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"20000\",\"40000\",\"60000\",\"80000\"],\"tickvals\":[0,20000,40000,59999.999999999993,80000],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"20000\",\"40000\",\"60000\",\"80000\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":\"\",\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":0.44465199944652001,\"y0\":0,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":\"rgba(217,217,217,1)\",\"line\":{\"color\":\"transparent\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":0.44465199944652001,\"y0\":0,\"y1\":23.37899543378996,\"yanchor\":1,\"ysizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.55534800055347999,\"x1\":1,\"y0\":0,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":\"rgba(217,217,217,1)\",\"line\":{\"color\":\"transparent\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.55534800055347999,\"x1\":1,\"y0\":0,\"y1\":23.37899543378996,\"yanchor\":1,\"ysizemode\":\"pixel\"}],\"xaxis2\":{\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,10.6],\"tickmode\":\"array\",\"ticktext\":[\"F1\",\"F2A\",\"F2B\",\"F4\",\"E1\",\"E2\",\"E3\",\"E4\",\"E5\",\"DV\"],\"tickvals\":[1,2,3,4,5,6.0000000000000009,7,8,9,10],\"categoryorder\":\"array\",\"categoryarray\":[\"F1\",\"F2A\",\"F2B\",\"F4\",\"E1\",\"E2\",\"E3\",\"E4\",\"E5\",\"DV\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"domain\":[0.55534800055347999,1],\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y2\",\"title\":\"\",\"hoverformat\":\".2f\"},\"yaxis2\":{\"type\":\"linear\",\"autorange\":false,\"range\":[-822.34999999999991,49477.349999999999],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"10000\",\"20000\",\"30000\",\"40000\"],\"tickvals\":[0,10000,20000,30000,40000],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"10000\",\"20000\",\"30000\",\"40000\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"domain\":[0,1],\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x2\",\"title\":\"\",\"hoverformat\":\".2f\"},\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"variable\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"orientation\":\"h\",\"x\":0.5,\"y\":-0.10000000000000001,\"traceorder\":\"normal\"},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"1ef3d11b03c\":{\"x\":{},\"y\":{},\"colour\":{},\"type\":\"scatter\"}},\"cur_data\":\"1ef3d11b03c\",\"visdat\":{\"1ef3d11b03c\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nI designed individual line graphs to better understand the data set. For 'Visa Issuances at Offices Abroad,' the values go up to **80,041**, while for **'USCIS Adjustments',** the highest values reach **47,191**. To comprehend the trends in both visa issuances and USCIS adjustments, I created two separate line graphs for a clearer analysis.\n\n![](images/redesign2.png){fig-align=\"center\"}\n\nRedesign_3\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2) \nlibrary(plotly) \n\nbase_plot <- ggplot(melted_data, aes(x = Category, y = value, size = value, color = variable)) + geom_point(alpha = 0.9) + labs(title = \"Bubble Chart of Visa Issuances and USCIS Adjustments\", x = \"Category\", y = \"Count\") + scale_color_manual(values = c(\"Visa_Issuances_At_Offices_Abroad\" = \"skyblue\", \"USCIS_Adjustments\" = \"red\")) + \ntheme( text = element_text(size = 10, face = \"bold\"), \n       axis.text.x = element_text(size = 10, face = \"bold\"), \n       axis.text.y = element_text(size = 10, face = \"bold\"), \n       axis.title.x = element_text(size = 12, face = \"bold\"), \n       axis.title.y = element_text(size = 12, face = \"bold\"), \n       plot.title = element_text(size = 10, face = \"bold\", hjust = 0.5)) \n\n# Convert ggplot to a plotly object \nhighlight_plot <- ggplotly(base_plot, tooltip = c(\"Category\", \"value\", \"variable\")) \n\n# Customize the layout \nhighlight_plot <- highlight_plot %>%layout( \n  title = list(text = \"Bubble Chart of Visa Issuances and USCIS Adjustments\", x = 0.5, xanchor = \"center\"), \n  legend = list(orientation = \"h\", x = 0.1, y = -0.3, traceorder = 'normal', title = list(text = NULL))) \n\n# Display the interactive plot \nhighlight_plot \n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-1078cac6a84467900b33\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-1078cac6a84467900b33\">{\"x\":{\"data\":[{\"x\":[1,2,3,4,5,6,7,8,9,10],\"y\":[21511,80041,15137,21931,59140,1680,1880,7088,1489,9228],\"text\":[\"Category: F1<br />value: 21511<br />value: 21511<br />variable: Visa_Issuances_At_Offices_Abroad\",\"Category: F2A<br />value: 80041<br />value: 80041<br />variable: Visa_Issuances_At_Offices_Abroad\",\"Category: F2B<br />value: 15137<br />value: 15137<br />variable: Visa_Issuances_At_Offices_Abroad\",\"Category: F4<br />value: 21931<br />value: 21931<br />variable: Visa_Issuances_At_Offices_Abroad\",\"Category: E1<br />value: 59140<br />value: 59140<br />variable: Visa_Issuances_At_Offices_Abroad\",\"Category: E2<br />value:  1680<br />value:  1680<br />variable: Visa_Issuances_At_Offices_Abroad\",\"Category: E3<br />value:  1880<br />value:  1880<br />variable: Visa_Issuances_At_Offices_Abroad\",\"Category: E4<br />value:  7088<br />value:  7088<br />variable: Visa_Issuances_At_Offices_Abroad\",\"Category: E5<br />value:  1489<br />value:  1489<br />variable: Visa_Issuances_At_Offices_Abroad\",\"Category: DV<br />value:  9228<br />value:  9228<br />variable: Visa_Issuances_At_Offices_Abroad\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(135,206,235,1)\",\"opacity\":0.90000000000000002,\"size\":[13.324715722800647,22.677165354330711,11.662530811495317,13.424186924352352,19.969919613330024,4.7703291024465857,5.1545394824528419,8.8352410558529471,4.1166050892872219,9.7197480041617634],\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(135,206,235,1)\"}},\"hoveron\":\"points\",\"name\":\"Visa_Issuances_At_Offices_Abroad\",\"legendgroup\":\"Visa_Issuances_At_Offices_Abroad\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1,2,3,4,5,6,7,8,9,10],\"y\":[2480,9451,2382,2100,7020,38928,47191,35611,6798,1464],\"text\":[\"Category: F1<br />value:  2480<br />value:  2480<br />variable: USCIS_Adjustments\",\"Category: F2A<br />value:  9451<br />value:  9451<br />variable: USCIS_Adjustments\",\"Category: F2B<br />value:  2382<br />value:  2382<br />variable: USCIS_Adjustments\",\"Category: F4<br />value:  2100<br />value:  2100<br />variable: USCIS_Adjustments\",\"Category: E1<br />value:  7020<br />value:  7020<br />variable: USCIS_Adjustments\",\"Category: E2<br />value: 38928<br />value: 38928<br />variable: USCIS_Adjustments\",\"Category: E3<br />value: 47191<br />value: 47191<br />variable: USCIS_Adjustments\",\"Category: E4<br />value: 35611<br />value: 35611<br />variable: USCIS_Adjustments\",\"Category: E5<br />value:  6798<br />value:  6798<br />variable: USCIS_Adjustments\",\"Category: DV<br />value:  1464<br />value:  1464<br />variable: USCIS_Adjustments\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(255,0,0,1)\",\"opacity\":0.90000000000000002,\"size\":[5.9283802908129024,9.8044525036530477,5.8221172677691282,5.4796819313680567,8.8045836911525583,16.828216284925766,18.195573368444691,16.237176153544645,8.7031677093514599,3.7795275590551185],\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(255,0,0,1)\"}},\"hoveron\":\"points\",\"name\":\"USCIS_Adjustments\",\"legendgroup\":\"USCIS_Adjustments\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":39.511830635118315,\"r\":7.3059360730593621,\"b\":43.105022831050235,\"l\":60.107928601079294},\"plot_bgcolor\":\"rgba(235,235,235,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":13.283520132835205},\"title\":{\"text\":\"Bubble Chart of Visa Issuances and USCIS Adjustments\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":13.283520132835205},\"x\":0.5,\"xref\":\"paper\",\"xanchor\":\"center\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,10.6],\"tickmode\":\"array\",\"ticktext\":[\"F1\",\"F2A\",\"F2B\",\"F4\",\"E1\",\"E2\",\"E3\",\"E4\",\"E5\",\"DV\"],\"tickvals\":[1,2,3,4,5,6.0000000000000009,7,8,9,10],\"categoryorder\":\"array\",\"categoryarray\":[\"F1\",\"F2A\",\"F2B\",\"F4\",\"E1\",\"E2\",\"E3\",\"E4\",\"E5\",\"DV\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":13.283520132835205},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"<b> Category <\\/b>\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":15.940224159402241}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-2464.8500000000004,83969.850000000006],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"20000\",\"40000\",\"60000\",\"80000\"],\"tickvals\":[0,20000,40000,60000,80000],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"20000\",\"40000\",\"60000\",\"80000\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":13.283520132835205},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"<b> Count <\\/b>\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":15.940224159402241}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":10.62681610626816},\"title\":{\"text\":[],\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":13.283520132835205}},\"orientation\":\"h\",\"x\":0.10000000000000001,\"y\":-0.29999999999999999,\"traceorder\":\"normal\"},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"1ef3319439f4\":{\"x\":{},\"y\":{},\"size\":{},\"colour\":{},\"type\":\"scatter\"}},\"cur_data\":\"1ef3319439f4\",\"visdat\":{\"1ef3319439f4\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n",
    "supporting": [
      "Re-Design_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}